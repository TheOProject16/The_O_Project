<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The O Projekt – Theo wird schlau (offline)</title>
<style>
  :root{
    --bg:#f5f7f9; --fg:#111827; --muted:#4b5563; --card:#ffffff;
    --accent:#2563eb; --ok:#16a34a; --err:#dc2626; --shadow:0 10px 24px rgba(0,0,0,.12);
    --claas-g1:#8DC63F; --claas-g2:#6AA528; --radius:14px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg)}
  .wrap{max-width:1100px;margin:28px auto;padding:0 16px}
  header{margin-bottom:16px}
  h1{margin:0 0 6px;font-size:2rem;letter-spacing:.5px;font-weight:900;text-transform:uppercase}
  h2{margin:.5rem 0 0}
  .lead{color:var(--muted);margin:0 0 10px}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr 1fr}}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
  .pill{display:inline-block;background:#eef2ff;color:#3730a3;border-radius:999px;padding:6px 10px;font-weight:800}
  .muted{color:var(--muted)}
  button{border:0;border-radius:12px;padding:12px 14px;font-weight:800;cursor:pointer}
  .btn{background:var(--accent);color:#fff}
  .btn.secondary{background:#e5e7eb;color:#111827}
  .btn.ghost{background:transparent;color:var(--accent)}
  .statusline{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin:10px 0 0}
  .divider{height:1px;background:#e5e7eb;margin:12px 0}
  .center{text-align:center}
  .big{font-size:1.15rem}
  .hidden{display:none !important}
  ul.clean{margin:0;padding-left:18px}

  /* Startseite – CLAAS-Look Topic Tiles (offline) */
  .topic{
    display:flex;flex-direction:column;gap:10px;padding:16px;border-radius:16px;
    color:#fff;box-shadow:var(--shadow);position:relative;overflow:hidden;
    background:linear-gradient(135deg,var(--claas-g1),var(--claas-g2));
  }
  .topic h3{
    margin:0;font-size:1.2rem;letter-spacing:.3px;font-weight:900;text-transform:uppercase
  }
  .topic .sub{opacity:.95}
  .topic .cta{align-self:flex-start;background:#fff;color:#1b3b0b}
  .topic.locked{opacity:.55;filter:saturate(.75);pointer-events:none}
  .badge-lock{
    position:absolute;top:12px;right:12px;background:rgba(255,255,255,.18);
    padding:4px 8px;border-radius:999px;font-size:.85rem
  }

  /* Quiz */
  .qbox{margin:10px 0;font-weight:800;font-size:1.1rem}
  .options{display:grid;gap:10px;margin:10px 0}
  .opt{border:2px solid #e5e7eb;padding:12px;border-radius:12px;background:#fff;cursor:pointer;transition:.15s}
  .opt:hover{border-color:#cbd5e0;transform:translateY(-1px)}
  .opt.selected{outline:3px solid rgba(37,99,235,.25)}
  .opt.correct{border-color:var(--ok);background:#ecfdf5}
  .opt.incorrect{border-color:var(--err);background:#fef2f2}
  .progress{color:var(--muted);font-size:.95rem}

  /* Mini-Lernkasten */
  .learnbox{
    background:#f0f7e9;border:1px solid #d4e7bf;border-radius:12px;padding:12px;margin:12px 0 6px;
  }
  .learnbox h3{ margin:0 0 6px; font-size:1rem; text-transform:uppercase; letter-spacing:.3px }
  .learnbox ul{ margin:0; padding-left:18px }
  .learnbox li{ margin:4px 0 }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>The O Projekt – Theo wird schlau</h1>
    <p class="lead">Wähle ein Thema, lies den Text (ca. 400–800 Zeichen) und beantworte 5 anspruchsvolle Fragen. Jede richtige Antwort bringt 1 Punkt. Jedes Thema ist nur einmal spielbar.</p>
  </header>

  <!-- HOME -->
  <section id="home" class="card">
    <div class="statusline">
      <span class="pill" id="scoreBadge">Punkte: 0</span>
      <span class="progress" id="progressText">0 / 5 Themen erledigt</span>
    </div>
    <div class="divider"></div>
    <div id="topics" class="grid"></div>
    <div id="finishBox" class="hidden">
      <div class="divider"></div>
      <div class="center big" id="finalCongrats"></div>
      <div class="divider"></div>
      <div id="finalTable"></div>
    </div>
  </section>

  <!-- TOPIC VIEW -->
  <section id="topicView" class="card hidden">
    <button class="btn ghost" id="backHome">⟵ Zur Startseite</button>
    <h2 id="topicTitle" style="margin:.5rem 0 0;text-transform:uppercase;letter-spacing:.3px"></h2>
    <p class="muted" id="topicIntro"></p>

    <div class="learnbox" id="learnBox">
      <h3>Mini-Lernkasten</h3>
      <ul id="learnList"></ul>
    </div>

    <div class="center"><button class="btn" id="startQuiz">Quiz starten</button></div>
  </section>

  <!-- QUIZ VIEW -->
  <section id="quizView" class="card hidden">
    <div class="statusline">
      <span class="pill" id="topicScoreBadge">Themenpunkte: 0/5</span>
      <span class="progress" id="qProgress">Frage 1 / 5</span>
    </div>
    <div class="divider"></div>
    <div class="qbox" id="questionText"></div>
    <div id="optionsBox" class="options"></div>
    <div class="statusline">
      <button class="btn secondary" id="prevQ">Zurück</button>
      <button class="btn" id="checkQ">Antwort prüfen</button>
      <button class="btn secondary" id="nextQ">Weiter</button>
    </div>
    <p class="muted" id="feedback"></p>
  </section>
</div>

<script>
/* ======== DATEN ======== */
/* Pro Thema: Intro (~700 Zeichen), Mini-Lernkasten (2–3 Stichpunkte), 5 Fragen (4. Klasse, anspruchsvoll). */
const TOPICS = [
  {
    id:"john-deere", title:"John Deere",
    intro:`John Deere steht weltweit für Landmaschinen, die Felder produktiver und schonender bewirtschaften. Traktoren, Mähdrescher und Häcksler verbinden starke Motoren mit präziser Steuerung. GPS und Spurassistenten helfen, Bahnen exakt zu fahren und Saatgut, Dünger sowie Zeit zu sparen. Sensoren messen Ertrag oder Feuchte, Daten werden in Apps sichtbar und erleichtern Entscheidungen. Werkstätten, Ersatzteile und Schulungen sorgen dafür, dass Maschinen zuverlässig laufen. Wichtig bleiben Sicherheit und Pflege: tägliche Checks, klare Handzeichen im Team und auf der Straße Licht, Bremsen und Planen prüfen.`,
    learn:[
      "GPS-Spuren reduzieren Überlappungen und sparen Betriebsmittel.",
      "Telemetrie-Daten helfen bei Wartung und besseren Entscheidungen.",
      "Sicherheit zuerst: Sicht, Bremsen, Signale – immer prüfen."
    ],
    questions:[
      { q:"Wozu nutzt John Deere GPS im Feld am meisten?",
        opts:["Gerade Bahnen, weniger Überlappung","Schönere Fotos","Lautere Motoren","Bunte Reifen"], a:0 },
      { q:"Was liefern Sensoren am Mähdrescher oft?",
        opts:["Ertrags- und Feuchtedaten","Musik-Playlists","Duftsignale","Reifenfarben"], a:0 },
      { q:"Warum spart exakte Spurführung Ressourcen?",
        opts:["Weil doppelte Fahrten sinken","Weil der Motor zaubert","Weil Reifen kleiner werden","Weil Wolken tiefer hängen"], a:0 },
      { q:"Was gehört zur täglichen Maschinenpflege?",
        opts:["Sicht-, Öl- und Reifencheck","Aufkleber zählen","Hupen polieren","Sitz lackieren"], a:0 },
      { q:"Welche Maßnahme erhöht die Straßensicherheit?",
        opts:["Licht/Bremsen testen, Ladung sichern","Fenster offen lassen","Sehr schnell hupen","Planen entfernen"], a:0 }
    ]
  },
  {
    id:"plants", title:"Wie wachsen Pflanzen?",
    intro:`Pflanzen wachsen, weil sie Energie aus Licht gewinnen. In den Blättern sitzt Chlorophyll, das bei der Fotosynthese aus Wasser, Kohlendioxid und Licht Zucker baut. Dieser Zucker ist ihr „Treibstoff“ und Baustoff zugleich. Die Wurzeln verankern die Pflanze, nehmen Wasser und Nährstoffe wie Stickstoff oder Kalium auf. Stängel leiten Wasser nach oben, Blätter geben über kleine Öffnungen (Spaltöffnungen) Gase ab und nehmen CO₂ auf. Temperatur, Lichtdauer und genug Platz entscheiden, wie gut eine Pflanze gedeiht. Zu wenig Licht, trockene Erde oder Staunässe bremsen das Wachstum – Gleichgewicht ist der Schlüssel.`,
    learn:[
      "Fotosynthese: Licht + Wasser + CO₂ → Zucker + Sauerstoff.",
      "Wurzeln: Wasser/Nährstoffe; Blätter: Gas­austausch.",
      "Gleichgewicht bei Licht und Wasser ist entscheidend."
    ],
    questions:[
      { q:"Wofür ist Chlorophyll wichtig?",
        opts:["Es ermöglicht Fotosynthese","Es macht Erde fruchtbar","Es kühlt Luft","Es hält Regen ab"], a:0 },
      { q:"Welche Aufgabe haben Spaltöffnungen?",
        opts:["Gasaustausch der Blätter","Samen festhalten","Stängel wärmen","Blüten polieren"], a:0 },
      { q:"Was passiert bei zu wenig Licht?",
        opts:["Wachstum verlangsamt sich","Pflanze wird lauter","Mehr Blüten sofort","Erde wird blau"], a:0 },
      { q:"Welche Nährstoffe nimmt die Pflanze über Wurzeln auf?",
        opts:["Zum Beispiel Stickstoff und Kalium","Helium und Neon","Zuckerwürfel","Eisenbahnen"], a:0 },
      { q:"Warum ist Wasserüberschuss schlecht?",
        opts:["Staunässe erstickt Wurzeln","Weil Blätter zu hart werden","Weil Licht dunkler wird","Weil Stängel verschwinden"], a:0 }
    ]
  },
  {
    id:"ski", title:"Skifahren",
    intro:`Beim Skifahren gleitest du auf zwei Brettern über Schnee. Die Kanten der Ski greifen im Eis, damit du lenken und bremsen kannst. Beim Carven belastest du abwechselnd Außen- und Innenski, der Körper beugt sich in die Kurve. Helm, Brille und angepasste Bindung sind Pflicht für Sicherheit. Pistenfarben zeigen die Schwierigkeit: blau (leicht), rot (mittel), schwarz (schwer). Vor der Abfahrt checkst du Wetter, Sicht und Lawinenlage. Auf der Piste gilt Rücksicht: langsamere Fahrer haben Vorrang, Anhalten nur übersichtlich am Rand. Mit Rhythmus, ruhigen Armen und Blick nach vorn bleibst du stabil.`,
    learn:[
      "Kanten steuern und bremsen – Carving durch Kantdruck.",
      "Schutzausrüstung: Helm, Brille, korrekt eingestellte Bindung.",
      "Pistenregeln: Rücksicht, Sicht prüfen, am Rand anhalten."
    ],
    questions:[
      { q:"Wofür brauchst du die Skikanten?",
        opts:["Zum Steuern und Bremsen","Zum Musikhören","Zum Schneefärben","Zum Springen ohne Schnee"], a:0 },
      { q:"Welche Pistenfarbe steht für leicht?",
        opts:["Blau","Rot","Schwarz","Grün"], a:0 },
      { q:"Was bedeutet Carven?",
        opts:["Kurven über Kantdruck fahren","Nur geradeaus fahren","Sitzen im Lift","Skier tragen"], a:0 },
      { q:"Was prüfst du vor der Abfahrt?",
        opts:["Wetter und Sicht","Eislutscherfarbe","Hüttenmusik","Skistöcke zählen"], a:0 },
      { q:"Wo hältst du am sichersten an?",
        opts:["Übersichtlich am Pistenrand","Mitten in einer Kuppe","Im Tunnel ohne Licht","Direkt in Toren"], a:0 }
    ]
  },
  {
    id:"skyscraper", title:"Wolkenkratzer",
    intro:`Wolkenkratzer sind Hochhäuser mit vielen Stockwerken. Sie stehen auf tiefen Fundamenten, oft Pfählen, die Last in tragfähigen Boden leiten. Ein Skelett aus Stahl oder Stahlbeton trägt das Gebäude, Querverbände und Kerne mit Treppenhäusern steifen es gegen Wind aus. Moderne Fassaden aus Glas sparen Energie mit Sonnenschutz und guter Dämmung. Hochgeschwindigkeitsaufzüge bringen Menschen schnell nach oben, Brandschutz trennt Bereiche und sichert Fluchtwege. Obwohl sich Türme im Wind leicht bewegen dürfen, sorgen Dämpfer dafür, dass es kaum spürbar ist. Planung und Wartung halten das System zuverlässig am Laufen.`,
    learn:[
      "Tragwerk: Stahl/Stahlbeton, Kern und Querverbände gegen Wind.",
      "Fundamente leiten Lasten tief in den Boden.",
      "Aufzüge und Brandschutz sind zentrale Systeme."
    ],
    questions:[
      { q:"Wozu dienen tiefe Fundamente?",
        opts:["Sie tragen die Last sicher in den Boden","Sie machen Glas bunter","Sie speichern Musik","Sie halten Regen ab"], a:0 },
      { q:"Was versteift den Turm gegen Wind?",
        opts:["Kern und Querverbände","Bunte Vorhänge","Dachgärten allein","Fensterputzer"], a:0 },
      { q:"Wozu sind Dämpfer im Hochhaus da?",
        opts:["Sie reduzieren spürbare Schwingungen","Sie heizen Wasser","Sie malen Wände an","Sie öffnen Türen"], a:0 },
      { q:"Welche Aufgabe hat die Fassade?",
        opts:["Schützt und spart Energie","Dient als Rutsche","Kocht Suppe","Spielt Filme ab"], a:0 },
      { q:"Warum sind Aufzüge so wichtig?",
        opts:["Schneller Transport über viele Etagen","Weil Treppen verboten sind","Weil sie Musik spielen","Weil sie das Haus kühlen"], a:0 }
    ]
  },
  {
    id:"dubai-choc", title:"Dubai Schokolade",
    intro:`Schokolade entsteht aus Kakaobohnen, die in tropischen Ländern wachsen. In Dubai gibt es keine Kakaoplantagen, aber eine lebendige Genusskultur: Man veredelt importierte Bohnen oder Kuvertüren und kombiniert sie mit Datteln, Nüssen oder Gewürzen. Das heiße Klima stellt besondere Anforderungen: Kühlketten, schattige Logistik und klimatisierte Läden schützen Aroma und Form. Chocolatiers temperieren die Masse exakt, damit sie glänzt und knackig bricht. Verpackungen mit Isolierung helfen beim Transport. So wird aus einer globalen Lieferkette vor Ort ein edles Produkt – oft als Geschenk in prächtigen Schachteln.`,
    learn:[
      "Kakao wächst tropisch – Dubai veredelt, nicht baut an.",
      "Hitze → Kühlkette, Temperieren, klimatisierte Shops.",
      "Datteln & Gewürze sind typische Kombinationen."
    ],
    questions:[
      { q:"Warum braucht Schokolade in Dubai besondere Logistik?",
        opts:["Wegen der Hitze – Kühlung schützt Qualität","Weil Kakao laut ist","Weil Läden dunkel sind","Weil Wasser gefriert"], a:0 },
      { q:"Was bedeutet Temperieren von Schokolade?",
        opts:["Genaues Erwärmen/Abkühlen für Glanz und Knack","Mit Gewürzen bestreuen","Mit Wasser mischen","In der Sonne trocknen"], a:0 },
      { q:"Wo wachsen Kakaobohnen hauptsächlich?",
        opts:["In tropischen Regionen","In Wüstenoasen","Auf Gletschern","Unter Wasser"], a:0 },
      { q:"Welche Zutat passt typisch zu Dubai-Schokolade?",
        opts:["Datteln","Kohlrabi","Fischstäbchen","Olivenöl pur"], a:0 },
      { q:"Warum helfen isolierte Verpackungen?",
        opts:["Sie halten die Temperatur stabil","Sie machen sie lauter","Sie färben sie rosa","Sie machen sie leichter"], a:0 }
    ]
  }
];

/* ======== STATE ======== */
const state = {
  totalScore: 0,
  completed: {},       // {topicId:true}
  perTopicScore: {},   // {topicId:number}
  current: null,       // topic object
  qIndex: 0,
  selected: null
};

/* ======== HELPERS ======== */
const $ = sel => document.querySelector(sel);
function show(sel){ $(sel).classList.remove('hidden'); }
function hide(sel){ $(sel).classList.add('hidden'); }
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }}

/* ======== HOME ======== */
function renderHome(){
  $('#scoreBadge').textContent = `Punkte: ${state.totalScore}`;
  const done = Object.keys(state.completed).length;
  $('#progressText').textContent = `${done} / ${TOPICS.length} Themen erledigt`;

  const box = $('#topics'); box.innerHTML="";
  TOPICS.forEach(t=>{
    const played = !!state.completed[t.id];
    const tile = document.createElement('div');
    tile.className = 'topic' + (played ? ' locked' : '');
    tile.innerHTML = `
      <span class="badge-lock">${played ? 'Erledigt' : 'Neu'}</span>
      <h3>${t.title}</h3>
      <div class="sub">Status: ${played ? `Punkte ${state.perTopicScore[t.id] ?? 0}/5` : 'Noch nicht gespielt'}</div>
      <button class="cta btn">${played ? 'Schon gespielt' : 'Los geht’s'}</button>
    `;
    if(!played){
      tile.querySelector('.cta').addEventListener('click',()=>openTopic(t));
    }
    box.appendChild(tile);
  });

  if(done === TOPICS.length){
    $('#finishBox').classList.remove('hidden');
    const rows = TOPICS.map(t=>{
      const p = state.perTopicScore[t.id] ?? 0;
      return `<li><strong>${t.title}:</strong> ${p}/5</li>`;
    }).join('');
    $('#finalTable').innerHTML = `<ul class="clean">${rows}</ul>`;
    $('#finalCongrats').textContent =
      `Glückwunsch Theo, Gut gemacht🎇 Gesamtscore: ${state.totalScore}/${TOPICS.length*5}`;
  } else {
    $('#finishBox').classList.add('hidden');
    $('#finalTable').innerHTML = '';
    $('#finalCongrats').textContent = '';
  }

  hide('#topicView'); hide('#quizView'); show('#home');
}

/* ======== TOPIC VIEW ======== */
function openTopic(topic){
  state.current = topic;
  $('#topicTitle').textContent = topic.title;
  $('#topicIntro').textContent = topic.intro;
  // Mini-Lernkasten füllen
  const ul = $('#learnList'); ul.innerHTML = '';
  topic.learn.forEach(point=>{
    const li = document.createElement('li'); li.textContent = point; ul.appendChild(li);
  });
  show('#topicView'); hide('#quizView'); hide('#home');
}
$('#backHome').addEventListener('click', renderHome);

$('#startQuiz').addEventListener('click', ()=>{
  if(!state.current) return;
  state.qIndex = 0; state.selected = null;
  state.perTopicScore[state.current.id] = state.perTopicScore[state.current.id] ?? 0;
  shuffle(state.current.questions);  // Fragen mischen
  renderQuestion();
  hide('#topicView'); show('#quizView');
});

/* ======== QUIZ ======== */
function renderQuestion(){
  const t = state.current, qi = state.qIndex, q = t.questions[qi];
  $('#topicScoreBadge').textContent = `Themenpunkte: ${state.perTopicScore[t.id]}/5`;
  $('#qProgress').textContent = `Frage ${qi+1} / ${t.questions.length}`;
  $('#questionText').textContent = q.q;
  $('#feedback').textContent = '';
  const box = $('#optionsBox'); box.innerHTML = '';

  // Antworten mischen
  const order = q.opts.map((_,i)=>i); shuffle(order);
  order.forEach(i=>{
    const b = document.createElement('button');
    b.className='opt';
    b.textContent = q.opts[i];
    b.addEventListener('click', ()=>{
      state.selected = i;
      [...box.children].forEach(x=>x.classList.remove('selected'));
      b.classList.add('selected');
    });
    box.appendChild(b);
  });
}

function checkAnswer(){
  const t = state.current, q = t.questions[state.qIndex];
  if(state.selected == null){ $('#feedback').textContent = 'Bitte wähle zuerst eine Antwort.'; return; }
  const correct = state.selected === q.a;
  if(correct){
    if(!q._counted){ state.perTopicScore[t.id]++; q._counted = true; }
    $('#feedback').textContent = 'Richtig! 👍';
  } else {
    $('#feedback').textContent = 'Nicht ganz – vergleiche Frage und Mini-Lernkasten.';
  }
  // Markieren
  const children = [...$('#optionsBox').children];
  children.forEach((btn)=>{
    const isCorrect = (btn.textContent === q.opts[q.a]);
    btn.classList.add(isCorrect ? 'correct' : 'incorrect');
    btn.disabled = true;
  });
  $('#topicScoreBadge').textContent = `Themenpunkte: ${state.perTopicScore[t.id]}/5`;
}

function nextQuestion(){
  const t = state.current;
  if(state.qIndex < t.questions.length-1){
    state.qIndex++; state.selected=null; renderQuestion();
  } else {
    state.completed[t.id] = true;
    state.totalScore = Object.values(state.perTopicScore).reduce((a,b)=>a+b,0);
    renderHome();
  }
}
function prevQuestion(){
  if(state.qIndex>0){ state.qIndex--; state.selected=null; renderQuestion(); }
}

/* ======== EVENTS ======== */
$('#checkQ').addEventListener('click', checkAnswer);
$('#nextQ').addEventListener('click', nextQuestion);
$('#prevQ').addEventListener('click', prevQuestion);

/* ======== START ======== */
renderHome();
</script>
</body>
</html>